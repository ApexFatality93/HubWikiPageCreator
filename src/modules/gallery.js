(()=>{if(window.matchMedia("(pointer: coarse)").matches)return;const e=document.createElement("script");e.src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js",document.head.appendChild(e),e.onload=()=>{const e=globalElements.output.galleryItems;new Sortable(e,{handle:".handle",animation:250,onUpdate:function(e){moveItem(e)}})},cachedHTML.files.add("src/htmlSnippets/galleryInput.html")})();let galleryUploadShown=!1;async function galleryUpload(){const e=globalElements.input.galleryUpload;if(!e.value)return;const{galleryItems:t,galleryCode:n}=globalElements.output,l=new Array;for(const o of e.files){const e=o.name;if(o.size>1e7){l.push(e);continue}const a=t.children,r=getChildIndex(a,"id"),i=(()=>{const t=document.createElement("p"),n=document.createElement("span");return t.innerText=e,n.classList.add("has-text-weight-bold"),n.innerText="Name: ",t.insertAdjacentElement("afterbegin",n),t.outerHTML})(),d={imgUrlData:URL.createObjectURL(o),inputId:"pic"+r,dropdownId:"dropdown"+r,galleryId:"gallery"+r,wikiCodeGalleryId:"wikiCodeGallery"+r,wikiCodeGalleryValueId:"wikiCodeGalleryValue"+r,nameElement:i},s=await loadHTML("src/htmlSnippets/galleryInput.html",d),c=`<div id="${d.wikiCodeGalleryId}">\n\t\t<span>${e}</span><output id="${d.wikiCodeGalleryValueId}"></output>\n\t\t</div>`;t.insertAdjacentHTML("afterbegin",s.body.innerHTML),n.insertAdjacentHTML("afterbegin",c);const m=document.getElementById(d.dropdownId);"function"==typeof generateGalleryArray&&generateGalleryArray();const u=pageData.galleryArray;u?setDropdownOptions(m,u):m.parentElement.style.display="none"}errorMessage(e,l.length?`The following files exceed the 10MB upload limit and couldn't be added:<br>${l.join(",<br>")}`:null),galleryUploadShown||("function"==typeof galleryExplanationExternal&&explanation("Gallery",`${galleryExplanationExternal()}\n\t\t<div class="mt-3"><span class="has-text-weight-bold">NOTE</span>: You can access this popup at any time by clicking on the "?" next to the gallery upload button.</div>`),galleryUploadShown=!0)}function galleryDesc(e,t,n){const l=e.value,o=document.getElementById(t);o.value=l,galleryInput(o,n)}function galleryInput(e,t){const n=sanitiseString(e.value);document.getElementById(t).innerText=n?"|"+n:""}function rmGallery(e,t){document.getElementById(t).remove(),e.closest(".gallery-item").remove()}function moveItem(e){const t=e.oldIndex,n=e.newIndex,l=Array.from(document.getElementById("galleryCode").children),o=l.splice(t,1);l.splice(n,0,o[0]);const a=new Array;for(const e of l){const t=e.outerHTML;a.push(t)}document.getElementById("galleryCode").innerHTML=a.join("")}function mobileMoveItem(e,t,n){const l=[e.closest(".gallery-item"),document.getElementById(t)];for(const e of l){const t=e.parentNode;"up"==n&&e.previousElementSibling?t.insertBefore(e,e.previousElementSibling):"down"==n&&e.nextElementSibling&&t.insertBefore(e,e.nextElementSibling.nextElementSibling)}}function resetGallery(){globalElements.output.galleryItems.innerHTML=""}
