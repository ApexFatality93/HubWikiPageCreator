const footerElements={input:{settings:"settings"}};function switchTheme(){document.documentElement.dataset.transition="true","light"==localStorage.getItem("theme")?(localStorage.setItem("theme","dark"),document.documentElement.dataset.theme="dark"):(localStorage.setItem("theme","light"),document.documentElement.dataset.theme="light"),setTimeout((()=>{delete document.documentElement.dataset.transition}),400)}function showSettings(){restoreDefaults();const e=globalElements.input.settings;e.style.scale="0",e.showModal(),e.style.scale="1",e.scrollTo(0,0);const t=JSON.parse(localStorage.getItem("defaultSettings"))??new Object;for(const o in t){const a=e.querySelector(`.data [data-store="${o}"]`);if(a)switch(a.value=t[o],a.id){case"civDefault":a.onchange();break;case"portalglyphsDefault":executeOnInput(a)}}hideDiscoverer(),delete pageData.restored}function updateDefaultValues(){if(pageData.restored)return localStorage.removeItem("defaultSettings"),void delete pageData.restored;const e=new Object,t=footerElements.inputs;for(const o of t){const t=o?.value,a=o?.dataset?.store;(o?.options?.[o.options.length-1]?.value==t||t)&&a&&(e[a]=sanitiseString(t))}localStorage.setItem("defaultSettings",JSON.stringify(e))}function readDefaultValues(){const e=JSON.parse(localStorage.getItem("defaultSettings"))??new Object;for(const t in e){const o=t.split(" ").length>1?t.split(" ").map((e=>document.getElementById(e))).find((e=>e)):document.getElementById(t);if(o)switch(o.value=e[t],t){case"civInput":pageData.civShort=e[t],researchTeamDropdown();break;case"portalglyphsInput":executeOnInput(o)}}}function restoreDefaults(){const e=footerElements.inputs;for(const t of e)null!=t?.value&&("select"==t.tagName.toLowerCase()?t.value=t.options?.[0]?.value:t.value="");hideDiscoverer(),pageData.restored=!0}function validateGlyphSettings(e){const t=e.value,o=structuredClone(regions);addHuburbs(o),Object.freeze(o);const a=validateGlyphs(t,globalElements.input.civDefault.value,o);glyphError(a,e),globalElements.input.settings.querySelector("form button.is-primary").disabled=null==a}(async()=>{let e=localStorage.getItem("theme")??"light";!localStorage.getItem("theme")&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(e="dark"),"dark"==e&&(document.documentElement.dataset.theme="dark"),localStorage.getItem("theme")||localStorage.setItem("theme",e);const t=await loadHTML("src/htmlSnippets/footer.html"),o=t.getElementById("about");o.href==window.location&&o.remove();const a=t.body.innerHTML;"undefined"==typeof globalElements?document.getElementById("footer").innerHTML=a:globalElements.output.footer.innerHTML=a;const l=document.querySelectorAll("footer dialog .data>*");l.forEach((e=>{footerElements.input[e.id]=e.id,e.dataset.store&&assignFunction(e,"delete pageData.restored")})),updateGlobalElements(footerElements),footerElements.inputs=l,addPortalGlyphButtons(globalElements.input.settingsPortalglyphButtons,"portalglyphsDefault");assignElementFunctions({civDefault:["researchTeamDropdown(globalElements.input.researchteamDefault, this.value)"],discoveredDefault:['hideDiscoverer("discoveredDefault", "discoveredlinkDefault")'],discoveredlinkDefault:['hideDiscoverer("discoveredlinkDefault", "discoveredDefault")'],portalglyphsDefault:['glyphInputOnChange(this); validateGlyphSettings(this); document.getElementById("settingsPortalglyphsPreview").value = validateGlyphInput(this.value)']})})();
